<script>
  $('.datepicker').pickadate()
  $('.timepicker').pickatime()
</script>

<div class="admin container">
  <h1 class="col-md-12 text-center">Manage Events</h1>

  <div class="col-md-3">
    <h2>Add Event</h2>
    <form class="thing-form" name="eventsForm" ng-submit="addEvent(eventsForm.$valid)" novalidate>
      <label><i class="fa fa-asterisk"></i>Name of Event</label>
      <p class="input-group" ng-class="{ 'has-error' : eventsForm.name.$invalid && !eventsForm.name.$pristine }">
        <input type="text" name="name" class="form-control" placeholder="Event Title" ng-model="newName" required>
        <p ng-show="eventsForm.name.$invalid && !eventsForm.name.$pristine" class="help-block">You must enter a name</p>
      </p>
      <label><i class="fa fa-asterisk"></i>Date of Event:</label>
      <p class="input-group" ng-class="{ 'has-error' : eventsForm.date.$invalid && !eventsForm.date.$pristine }">
        <input type="number" name="date" class="form-control datepicker" placeholder="Event Date" ng-model="newDate" required>
        <p ng-show="eventsForm.date.$invalid && !eventsForm.date.$pristine" class="help-block">You must enter a date</p>
      </p>
      <label>Time of Event:</label>
      <p class="input-group">
        <input type="text" class="form-control timepicker" placeholder="Event Time" pick-a-date-options="dateOptions" ng-model="newTime">
      </p>
      <label>Name of Venue:</label>
      <p class="input-group">
        <input type="text" class="form-control" placeholder="Event Venue" ng-model="newVenue">
      </p>
      <label><i class="fa fa-asterisk"></i>City:</label>
      <p class="input-group" ng-class="{ 'has-error' : eventsForm.city.$invalid && !eventsForm.city.$pristine }">
        <input type="text" name="city" class="form-control" placeholder="Event City" ng-model="newCity" required>
        <p ng-show="eventsForm.city.$invalid && !eventsForm.city.$pristine" class="help-block">You must enter a city</p>
      </p>
      <label>Info:</label>
      <p class="input-group">
        <input type="text" class="form-control" placeholder="Event Info" ng-model="newInfo">
      </p>
      <label>Link:</label>
      <p class="input-group">
        <input type="text" class="form-control" placeholder="Event Link" ng-model="newLink">
      </p>
      <label>Address:</label>
      <p class="input-group">
        <input type="text" class="form-control" placeholder="Event Longitude" ng-model="newLng">
      </p>
      <p class="input-group">
        <input type="text" class="form-control" placeholder="Event Latitude" ng-model="newLat">
      </p>
      <label>Map Zoom:</label>
      <p class="input-group">
        <select ng-model="newZoom" ng-options="l as l for l in levels" ng-init="newZoom = levels[14]">
        </select>
      </p>
      <p class="input-group">
        <button type="submit" class="btn btn-primary" ng-disabled="eventsForm.$invalid">Add New</button>
      </p>
    </form>
  </div>

  <div class="col-md-9">
    <ul class="admin events">
      <li ng-repeat="event in events | orderBy: 'date':reverse" class="well well-lg">
        <button type="button" class="btn btn-danger btn-xs" ng-click="confirmDelete(event.name, event)"><i class="fa fa-times"></i></button>
        <div>
          <h2>
            <a href="#" editable-text="event.name" onaftersave="updateEvent(event)">
              {{ event.name || "empty" }}
            </a>
          </h2>
        </div>
        <label>Date</label>
        <div>
          <a href="#" editable-bsdate="event.date" e-datepicker-popup="dd-MMMM-yyyy" onaftersave="updateEvent(event)">
            {{ (event.date | date:"dd/MM/yyyy") || 'empty' }}
          </a>
        </div>
        <label>Time</label>
        <div>
          <a href="#" editable-text="event.time" onaftersave="updateEvent(event)">
            {{ event.time || "empty" }}
          </a>
        </div>
        <label>Venue</label>
        <div>
          <a href="#" editable-text="event.venue" onaftersave="updateEvent(event)">
            {{ event.venue || "empty" }}
          </a>
        </div>
        <label>City</label>
        <div>
          <a href="#" editable-text="event.city" onaftersave="updateEvent(event)">
            {{ event.city || "empty" }}
          </a>
        </div>
        <label>Link</label>
        <div>
          <a href="#" editable-text="event.link" onaftersave="updateEvent(event)">
            {{ event.link || "empty" }}
          </a>
        </div>
        <label>Info</label>
        <div>
          <a href="#" editable-text="event.info" ng-bind-html="event.info || 'empty'" onaftersave="updateEvent(event)">
            {{ event.info || "empty" }}
          </a>
        </div>
        <label>Address</label>
        <div>
          <a href="#" editable-text="event.lng" onaftersave="updateEvent(event)">
            {{ event.lng || "Longitude" }}
          </a>,
          <a href="#" editable-text="event.lat" onaftersave="updateEvent(event)">
            {{ event.lat || "Latitude" }}
          </a>
        </div>
        <label ng-if="event.lat != null && event.lng != null">Zoom</label>
        <p ng-if="event.lat != null && event.lng != null">Choose a value between 1 and 19 (15 default)</p>
        <div ng-if="event.lat != null && event.lng != null">
          <a ng-model="edits" href="#" editable-range="event.zoom" e-min="1" e-max="19" onaftersave="updateEvent(event)">
            {{ event.zoom || "empty" }}
          </a>
        </div>
        <ui-gmap-google-map ng-if="event.lat != null && event.lng != null" center="[event.lat, event.lng ]" zoom='event.zoom' options='options'>
          <ui-gmap-marker idkey="event.venue" coords="[event.lat, event.lng ]">
          </ui-gmap-marker>
        </ui-gmap-google-map>
      </li>
    </ul>
  </div>
</div>
